INFO:     127.0.0.1:55138 - "POST /api/v1/analyses HTTP/1.1" 500 Internal Server Error
{
    "body": "OpenAI request failed",
    "severity_number": 13,
    "severity_text": "WARN",
    "attributes": {
        "operation": "openai.generate_structured",
        "attempt": 1,
        "model": "gpt-4.1-mini",
        "retryable": false,
        "code.file.path": "/home/ujjal/code/CustomerCallCenterAnalytics/src/infrastructure/llm/openai_wrapper.py",
        "code.function.name": "_invoke_with_retry",
        "code.line.number": 247,
        "exception.type": "TypeError",
        "exception.message": "Responses.create() got an unexpected keyword argument 'response_format'",
        "exception.stacktrace": "Traceback (most recent call last):\n  File \"/home/ujjal/code/CustomerCallCenterAnalytics/src/infrastructure/llm/openai_wrapper.py\", line 230, in _invoke_with_retry\n    response = call_fn()\n               ^^^^^^^^^\n  File \"/home/ujjal/code/CustomerCallCenterAnalytics/src/infrastructure/llm/openai_wrapper.py\", line 109, in call\n    return self.client.responses.create(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/ujjal/code/CustomerCallCenterAnalytics/venv/lib/python3.12/site-packages/opentelemetry/instrumentation/openai/utils.py\", line 119, in wrapper\n    return func(tracer, wrapped, instance, args, kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/ujjal/code/CustomerCallCenterAnalytics/venv/lib/python3.12/site-packages/opentelemetry/instrumentation/openai/v1/responses_wrappers.py\", line 441, in responses_get_or_create_wrapper\n    response = wrapped(*args, **kwargs)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\nTypeError: Responses.create() got an unexpected keyword argument 'response_format'\n"
    },
    "dropped_attributes": 0,
    "timestamp": "2025-09-19T16:53:57.564889Z",
    "observed_timestamp": "2025-09-19T16:53:57.565029Z",
    "trace_id": "0x95cd2fcf19232c39620a57a367d78aa3",
    "span_id": "0x8998f271b6abf41a",
    "trace_flags": 1,
    "resource": {
        "attributes": {
            "telemetry.sdk.language": "python",
            "telemetry.sdk.name": "opentelemetry",
            "telemetry.sdk.version": "1.36.0",
            "service.name": "xai",
            "service.version": "1.0.0"
        },
        "schema_url": ""
    },
    "event_name": ""
}
[12:53:57] ‚úì CREATE | 0.0s | db.system=sqlite db.name= db.statement=
           ...
[12:53:57] ‚úì CREATE | 0.0s | db.system=sqlite db.name= db.statement=
           ...
[12:53:57] ‚úì CREATE | 0.0s | db.system=sqlite db.name= db.statement=CREATE INDEX...
[12:53:57] ‚úì CREATE | 0.0s | db.system=sqlite db.name= db.statement=CREATE INDEX...
[12:53:57] ‚úì CREATE | 0.0s | db.system=sqlite db.name= db.statement=CREATE INDEX...
[12:53:57] ‚úì CREATE | 0.0s | db.system=sqlite db.name= db.statement=CREATE INDEX...
[12:53:57] ‚úì SELECT | 0.0s | db.system=sqlite db.name= db.statement=
           ...
[12:53:57] ‚úì SELECT | 0.0s | db.system=sqlite db.name= db.statement=
           ...
[12:53:57] ‚úó openai.response | 0.0s | error.type=TypeError genai.system=openai genai.request.model=gpt-4.1-mini genai.request.reasoningsummary=() genai.request.reasoningeffort=()
[12:53:57]   üìù exception | exception.type=TypeError exception.message=Responses.create() got an unexpected keyword argument 'response_format' exception.stacktrace=Traceback (most recent call last):
  File "/home/ujjal/code/CustomerCallCenterAnalytics/venv/lib/python3.12/site-packages/opentelemetry/instrumentation/openai/v1/responses_wrappers.py", line 441, in responses_get_or_create_wrapper
    response = wrapped(*args, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: Responses.create() got an unexpected keyword argument 'response_format'

[12:53:57] ‚úó openai.generate_structured | 0.0s | openai.model=gpt-4.1-mini openai.temperature=0.3 openai.attempt=1 openai.retryable=False
[12:53:57]   üìù exception | exception.type=TypeError exception.message=Responses.create() got an unexpected keyword argument 'response_format' exception.stacktrace=Traceback (most recent call last):
  File "/home/ujjal/code/CustomerCallCenterAnalytics/src/infrastructure/llm/openai_wrapper.py", line 230, in _invoke_with_retry
    response = call_fn()
               ^^^^^^^^^
  File "/home/ujjal/code/CustomerCallCenterAnalytics/src/infrastructure/llm/openai_wrapper.py", line 109, in call
    return self.client.responses.create(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ujjal/code/CustomerCallCenterAnalytics/venv/lib/python3.12/site-packages/opentelemetry/instrumentation/openai/utils.py", line 119, in wrapper
    return func(tracer, wrapped, instance, args, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ujjal/code/CustomerCallCenterAnalytics/venv/lib/python3.12/site-packages/opentelemetry/instrumentation/openai/v1/responses_wrappers.py", line 441, in responses_get_or_create_wrapper
    response = wrapped(*args, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: Responses.create() got an unexpected keyword argument 'response_format'

[12:53:57]   üìù exception | exception.type=TypeError exception.message=Responses.create() got an unexpected keyword argument 'response_format' exception.stacktrace=Traceback (most recent call last):
  File "/home/ujjal/code/CustomerCallCenterAnalytics/venv/lib/python3.12/site-packages/opentelemetry/trace/__init__.py", line 589, in use_span
    yield span
  File "/home/ujjal/code/CustomerCallCenterAnalytics/venv/lib/python3.12/site-packages/opentelemetry/sdk/trace/__init__.py", line 1105, in start_as_current_span
    yield span
  File "/home/ujjal/code/CustomerCallCenterAnalytics/src/infrastructure/llm/openai_wrapper.py", line 230, in _invoke_with_retry
    response = call_fn()
               ^^^^^^^^^
  File "/home/ujjal/code/CustomerCallCenterAnalytics/src/infrastructure/llm/openai_wrapper.py", line 109, in call
    return self.client.responses.create(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ujjal/code/CustomerCallCenterAnalytics/venv/lib/python3.12/site-packages/opentelemetry/instrumentation/openai/utils.py", line 119, in wrapper
    return func(tracer, wrapped, instance, args, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ujjal/code/CustomerCallCenterAnalytics/venv/lib/python3.12/site-packages/opentelemetry/instrumentation/openai/v1/responses_wrappers.py", line 441, in responses_get_or_create_wrapper
    response = wrapped(*args, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: Responses.create() got an unexpected keyword argument 'response_format'
